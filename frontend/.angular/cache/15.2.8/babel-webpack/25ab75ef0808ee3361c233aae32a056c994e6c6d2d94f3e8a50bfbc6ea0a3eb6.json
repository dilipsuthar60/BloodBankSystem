{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/hp/Documents/Arcs Infotech/blood-bank-system/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { map } from 'rxjs';\nimport Swal from 'sweetalert2';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@ngneat/hot-toast\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"../blood-bank.service\";\nimport * as i4 from \"@angular/common\";\nconst _c0 = function (a0, a1) {\n  return {\n    button: a0,\n    \"button-u\": a1\n  };\n};\nfunction DonorHomeComponent_div_13_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r3 = i0.ÉµÉµgetCurrentView();\n    i0.ÉµÉµelementStart(0, \"div\", 10)(1, \"div\", 11);\n    i0.ÉµÉµelement(2, \"img\", 12);\n    i0.ÉµÉµelementStart(3, \"div\", 13)(4, \"h5\", 14);\n    i0.ÉµÉµtext(5);\n    i0.ÉµÉµelementEnd();\n    i0.ÉµÉµelementStart(6, \"div\", 15)(7, \"div\", 16)(8, \"p\", 17);\n    i0.ÉµÉµtext(9, \"Organised By:\");\n    i0.ÉµÉµelementEnd();\n    i0.ÉµÉµelementStart(10, \"p\", 18);\n    i0.ÉµÉµtext(11);\n    i0.ÉµÉµelementEnd()();\n    i0.ÉµÉµelementStart(12, \"div\", 16)(13, \"p\", 17);\n    i0.ÉµÉµtext(14, \"Location:\");\n    i0.ÉµÉµelementEnd();\n    i0.ÉµÉµelementStart(15, \"p\", 18);\n    i0.ÉµÉµtext(16);\n    i0.ÉµÉµelementEnd()();\n    i0.ÉµÉµelementStart(17, \"div\", 19)(18, \"p\", 17);\n    i0.ÉµÉµtext(19, \"Date:\");\n    i0.ÉµÉµelementEnd();\n    i0.ÉµÉµelementStart(20, \"p\", 18);\n    i0.ÉµÉµtext(21);\n    i0.ÉµÉµelementEnd()()();\n    i0.ÉµÉµelementStart(22, \"p\", 20);\n    i0.ÉµÉµtext(23, \"Timings: \");\n    i0.ÉµÉµelementStart(24, \"span\", 21);\n    i0.ÉµÉµnamespaceSVG();\n    i0.ÉµÉµelementStart(25, \"svg\", 22);\n    i0.ÉµÉµelement(26, \"path\", 23);\n    i0.ÉµÉµelementEnd();\n    i0.ÉµÉµtext(27);\n    i0.ÉµÉµelementEnd();\n    i0.ÉµÉµtext(28, \"- \");\n    i0.ÉµÉµnamespaceHTML();\n    i0.ÉµÉµelementStart(29, \"span\", 24);\n    i0.ÉµÉµnamespaceSVG();\n    i0.ÉµÉµelementStart(30, \"svg\", 22);\n    i0.ÉµÉµelement(31, \"path\", 23);\n    i0.ÉµÉµelementEnd();\n    i0.ÉµÉµtext(32);\n    i0.ÉµÉµelementEnd()();\n    i0.ÉµÉµnamespaceHTML();\n    i0.ÉµÉµelementStart(33, \"button\", 25);\n    i0.ÉµÉµlistener(\"click\", function DonorHomeComponent_div_13_Template_button_click_33_listener() {\n      const restoredCtx = i0.ÉµÉµrestoreView(_r3);\n      const camp_r1 = restoredCtx.$implicit;\n      const ctx_r2 = i0.ÉµÉµnextContext();\n      return i0.ÉµÉµresetView(ctx_r2.onButtonClick(camp_r1));\n    });\n    i0.ÉµÉµtext(34);\n    i0.ÉµÉµelementEnd()()()();\n  }\n  if (rf & 2) {\n    const camp_r1 = ctx.$implicit;\n    const ctx_r0 = i0.ÉµÉµnextContext();\n    i0.ÉµÉµadvance(5);\n    i0.ÉµÉµtextInterpolate(camp_r1.name);\n    i0.ÉµÉµadvance(6);\n    i0.ÉµÉµtextInterpolate(camp_r1.createdBy);\n    i0.ÉµÉµadvance(5);\n    i0.ÉµÉµtextInterpolate(camp_r1.location);\n    i0.ÉµÉµadvance(5);\n    i0.ÉµÉµtextInterpolate(camp_r1.date);\n    i0.ÉµÉµadvance(6);\n    i0.ÉµÉµtextInterpolate1(\" \", ctx_r0.convertTo12HourFormat(camp_r1.startTime), \" \");\n    i0.ÉµÉµadvance(5);\n    i0.ÉµÉµtextInterpolate1(\" \", ctx_r0.convertTo12HourFormat(camp_r1.endTime), \" \");\n    i0.ÉµÉµadvance(1);\n    i0.ÉµÉµproperty(\"ngClass\", i0.ÉµÉµpureFunction2(8, _c0, !ctx_r0.registeredCamps[camp_r1.id], ctx_r0.registeredCamps[camp_r1.id]));\n    i0.ÉµÉµadvance(1);\n    i0.ÉµÉµtextInterpolate1(\" \", ctx_r0.registeredCamps[camp_r1.id] ? \"Unregister\" : \"Register\", \" \");\n  }\n}\nexport class DonorHomeComponent {\n  constructor(toast, router, route, bloodBankService) {\n    this.toast = toast;\n    this.router = router;\n    this.route = route;\n    this.bloodBankService = bloodBankService;\n    this.registeredCamps = {};\n  }\n  ngOnInit() {\n    this.route.queryParams.subscribe(params => {\n      this.donorId = Number(params['id']);\n    });\n    window.history.pushState({}, document.title, \"/\" + \"donor-home\");\n    // window.history.pushState({}, document.title);\n    this.postCamps();\n  }\n  postCamps() {\n    this.bloodBankService.getCamps().subscribe(data => {\n      this.camps = data;\n      // console.log(data);\n    });\n  }\n\n  convertTo12HourFormat(timeString) {\n    const [hours, minutes] = timeString.split(\":\");\n    let formattedTime;\n    let period;\n    if (hours < 12) {\n      formattedTime = hours;\n      period = \"AM\";\n    } else {\n      formattedTime = hours % 12;\n      period = \"PM\";\n    }\n    return `${formattedTime}:${minutes} ${period}`;\n  }\n  isRegistered(camp, donorId) {\n    const campId = camp.id;\n    const item = {\n      campId,\n      donorId\n    };\n    return this.bloodBankService.isRegister(item).pipe(map(data => data.isRegistered));\n  }\n  getRegistrationStatus(donorId) {\n    this.bloodBankService.campsRegistered(donorId).subscribe(data => {\n      // console.log(data);\n      this.registeredCamps = data.reduce((result, camp) => {\n        result[camp.id] = true;\n        return result;\n      }, {});\n    });\n  }\n  onButtonClick(camp) {\n    // const donorId = Number(this.route.snapshot.queryParams['id']);\n    const isRegistered = this.registeredCamps[camp.id] || false;\n    if (isRegistered) {\n      this.unregisterCamp(camp, this.donorId);\n    } else {\n      this.registerCamp(camp, this.donorId);\n    }\n  }\n  registerCamp(camp, donorId) {\n    const campId = camp.id;\n    const item = {\n      campId,\n      donorId\n    };\n    this.bloodBankService.registerDonor(item).subscribe(data => {\n      this.toast.success('Registered successfully');\n      this.registeredCamps[camp.id] = true;\n    }, error => {\n      this.toast.error(error.error.error.message);\n    });\n  }\n  unregisterCamp(camp, donorId) {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      const shouldDelete = yield Swal.fire({\n        title: 'Are you sure?',\n        text: 'You want to unregister from camp',\n        icon: 'question',\n        showCancelButton: true,\n        confirmButtonColor: '#3085d6',\n        cancelButtonColor: '#d33',\n        confirmButtonText: 'Yes'\n      });\n      if (!shouldDelete.isConfirmed) return;\n      const campId = camp.id;\n      const item = {\n        campId,\n        donorId\n      };\n      _this.bloodBankService.unregisterDonor(item).subscribe(data => {\n        _this.toast.success('Unregistered successfully');\n        _this.registeredCamps[camp.id] = false;\n      }, error => {\n        _this.toast.error(error.error.error.message);\n      });\n    })();\n  }\n}\nDonorHomeComponent.Éµfac = function DonorHomeComponent_Factory(t) {\n  return new (t || DonorHomeComponent)(i0.ÉµÉµdirectiveInject(i1.HotToastService), i0.ÉµÉµdirectiveInject(i2.Router), i0.ÉµÉµdirectiveInject(i2.ActivatedRoute), i0.ÉµÉµdirectiveInject(i3.BloodBankService));\n};\nDonorHomeComponent.Éµcmp = /*@__PURE__*/i0.ÉµÉµdefineComponent({\n  type: DonorHomeComponent,\n  selectors: [[\"app-donor-home\"]],\n  decls: 14,\n  vars: 1,\n  consts: [[1, \"relative\"], [1, \"absolute\", \"left-[30%]\", \"top-12\", \"text-center\", \"text-5xl\", \"uppercase\", \"font-bold\", \"leading-9\", \"tracking-wide\", \"text-rose-700\"], [1, \"absolute\", \"right-[32%]\", \"mr-2\", \"top-12\", \"text-center\", \"text-5xl\", \"uppercase\", \"font-bold\", \"leading-9\", \"tracking-wide\", \"text-rose-700\"], [1, \"heart\"], [1, \"heartbeat\"], [1, \"sm:mx-auto\", \"sm:w-full\", \"sm:max-w-sm\"], [\"src\", \"https://png.pngtree.com/element_our/20200609/ourlarge/pngtree-donate-blood-image_2224076.jpg\", \"alt\", \"Your Company\", 1, \"mx-auto\", \"mt-2\", \"w-32\", \"h-28\", \"shadow-danger\", \"shadow\"], [1, \"uppercase\", \"underline\", \"text-3xl\", \"my-2\", \"mt-4\", \"text-center\", \"text-rose-800\"], [1, \"flex\", \"flex-wrap\", \"justify-center\", \"overflow-hidden\"], [\"class\", \"m-4 shadow-lg\", 4, \"ngFor\", \"ngForOf\"], [1, \"m-4\", \"shadow-lg\"], [1, \"w-80\", \"border\", \"border-gray-200\", \"rounded-lg\", \"shadow\"], [\"src\", \"https://gozo.news/wp-content/uploads/2019/02/Save_Life_Give_Blood_Malta.png\", \"alt\", \"\", 1, \"rounded-t-lg\", \"ml-2\", \"h-36\", \"border-b-2\", \"border-b-rose-700\"], [1, \"p-5\", \"drop-shadow-sm\"], [1, \"mb-4\", \"text-xl\", \"uppercase\", \"underline\", \"text-center\", \"font-bold\", \"tracking-tight\", \"text-gray-900\"], [1, \"flex\", \"flex-col\"], [1, \"flex\", \"items-start\", \"mb-4\"], [1, \"mr-4\", \"font-bold\", \"text-gray-600\"], [1, \"font-normal\", \"text-gray-500\"], [1, \"flex\", \"items-start\", \"mb-3\"], [1, \"mb-4\", \"font-bold\", \"text-gray-600\"], [1, \"bg-gray-100\", \"text-gray-800\", \"text-xs\", \"ml-2\", \"font-medium\", \"inline-flex\", \"items-center\", \"px-2.5\", \"py-0.5\", \"rounded\", \"mr-2\", \"border\", \"border-gray-500\"], [\"aria-hidden\", \"true\", \"fill\", \"currentColor\", \"viewBox\", \"0 0 20 20\", \"xmlns\", \"http://www.w3.org/2000/svg\", 1, \"w-3\", \"h-3\", \"mr-1\"], [\"fill-rule\", \"evenodd\", \"d\", \"M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z\", \"clip-rule\", \"evenodd\"], [1, \"bg-gray-100\", \"text-gray-800\", \"text-xs\", \"font-medium\", \"inline-flex\", \"items-center\", \"px-2.5\", \"py-0.5\", \"rounded\", \"border\", \"border-gray-500\"], [1, \"mt-2\", \"w-full\", \"h-10\", \"text-center\", \"font-bold\", \"cursor-pointer\", 3, \"ngClass\", \"click\"]],\n  template: function DonorHomeComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ÉµÉµelementStart(0, \"div\", 0)(1, \"h1\", 1);\n      i0.ÉµÉµtext(2, \"Blood\");\n      i0.ÉµÉµelementEnd();\n      i0.ÉµÉµelementStart(3, \"h1\", 2);\n      i0.ÉµÉµtext(4, \"Bank \");\n      i0.ÉµÉµelementStart(5, \"span\", 3)(6, \"span\", 4);\n      i0.ÉµÉµtext(7, \"\\uD83E\\uDE78\");\n      i0.ÉµÉµelementEnd()()();\n      i0.ÉµÉµelementStart(8, \"div\", 5);\n      i0.ÉµÉµelement(9, \"img\", 6);\n      i0.ÉµÉµelementEnd();\n      i0.ÉµÉµelementStart(10, \"h1\", 7);\n      i0.ÉµÉµtext(11, \"Camps List\");\n      i0.ÉµÉµelementEnd()();\n      i0.ÉµÉµelementStart(12, \"div\", 8);\n      i0.ÉµÉµtemplate(13, DonorHomeComponent_div_13_Template, 35, 11, \"div\", 9);\n      i0.ÉµÉµelementEnd();\n    }\n    if (rf & 2) {\n      i0.ÉµÉµadvance(13);\n      i0.ÉµÉµproperty(\"ngForOf\", ctx.camps);\n    }\n  },\n  dependencies: [i4.NgClass, i4.NgForOf],\n  styles: [\"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJkb25vci1ob21lLmNvbXBvbmVudC5jc3MifQ== */\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvZG9ub3ItaG9tZS9kb25vci1ob21lLmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUNBLHdLQUF3SyIsInNvdXJjZVJvb3QiOiIifQ== */\"]\n});","map":{"version":3,"mappings":"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","names":["map","Swal","i0","DonorHomeComponent","constructor","toast","router","route","bloodBankService","ngOnInit","queryParams","subscribe","params","donorId","Number","window","history","pushState","document","title","postCamps","getCamps","data","camps","convertTo12HourFormat","timeString","hours","minutes","split","formattedTime","period","isRegistered","camp","campId","id","item","isRegister","pipe","getRegistrationStatus","campsRegistered","registeredCamps","reduce","result","onButtonClick","unregisterCamp","registerCamp","registerDonor","success","error","message","shouldDelete","fire","text","icon","showCancelButton","confirmButtonColor","cancelButtonColor","confirmButtonText","isConfirmed","unregisterDonor","selectors","decls","vars","consts","template"],"sourceRoot":"","sources":["C:\\Users\\hp\\Documents\\Arcs Infotech\\blood-bank-system\\src\\app\\donor-home\\donor-home.component.ts","C:\\Users\\hp\\Documents\\Arcs Infotech\\blood-bank-system\\src\\app\\donor-home\\donor-home.component.html"],"sourcesContent":["// import { Component } from '@angular/core';\n// import { ActivatedRoute, Router } from '@angular/router';\n// import { HotToastService } from '@ngneat/hot-toast';\n// import { BloodBankService } from '../blood-bank.service';\n// import { Observable, map } from 'rxjs';\n// import Swal from 'sweetalert2';\n\n// @Component({\n//   selector: 'app-donor-home',\n//   templateUrl: './donor-home.component.html',\n//   styleUrls: ['./donor-home.component.css']\n// })\n// export class DonorHomeComponent {\n//   registeredCamps: any = {};\n//   camps: any;\n\n//   constructor(\n//     private toast: HotToastService,\n//     private router: Router,\n//     private route: ActivatedRoute,\n//     private bloodBankService: BloodBankService\n//   ) {}\n\n//   ngOnInit(): void {\n//     this.postCamps();\n//     // this.getRegistrationStatus();\n//   }\n\n//   postCamps(): void {\n//     this.bloodBankService.getCamps().subscribe(\n//       (data: any) => {\n//         this.camps = data;\n//         // console.log(data);\n//       }\n//     );\n//   }\n\n//   convertTo12HourFormat(timeString: any): string {\n//     const [hours, minutes] = timeString.split(\":\");\n//     let formattedTime: number;\n//     let period: string;\n\n//     if (hours < 12) {\n//       formattedTime = hours;\n//       period = \"AM\";\n//     } else {\n//       formattedTime = hours % 12;\n//       period = \"PM\";\n//     }\n\n//     return `${formattedTime}:${minutes} ${period}`;\n//   }\n\n//   isRegistered(camp: any): Observable<boolean> {\n//     const campId = camp.id;\n//     const donorId = Number(this.route.snapshot.paramMap.get('id'));\n//     console.log(donorId)\n//     const item = {\n//       campId,\n//       donorId\n//     };\n\n//     return this.bloodBankService.isRegister(item).pipe(\n//       map((data: any) => data.isRegistered)\n//     );\n//   }\n\n//   getRegistrationStatus(): void {\n//     const donorId = Number(this.route.snapshot.paramMap.get('id'));\n//     this.bloodBankService.campsRegistered(donorId).subscribe(\n//       (data: any) => {\n//         // console.log(data);\n//         this.registeredCamps = data.reduce((result: any, camp: any) => {\n//           result[camp.id] = true;\n//           return result;\n//         }, {});\n//       }\n//     );\n//   }\n\n//   onButtonClick(camp: any) {\n//     const isRegistered = this.registeredCamps[camp.id] || false;\n\n//     if (isRegistered) {\n//       this.unregisterCamp(camp);\n//     } else {\n//       this.registerCamp(camp);\n//     }\n//   }\n\n//   registerCamp(camp: any) {\n//     const campId = camp.id;\n//     const donorId = Number(this.route.snapshot.paramMap.get('id'));\n//     const item = {\n//       campId,\n//       donorId\n//     };\n\n//     this.bloodBankService.registerDonor(item).subscribe(\n//       (data: any) => {\n//         this.toast.success('Registered successfully');\n//         this.registeredCamps[camp.id] = true;\n//       },\n//       (error: any) => {\n//         this.toast.error(error.error.error.message);\n//       }\n//     );\n//   }\n\n//   async unregisterCamp(camp: any) {\n//     const shouldDelete = await Swal.fire({\n//       title: 'Are you sure?',\n//       text: 'You want to unregister from camp',\n//       icon: 'question',\n//       showCancelButton: true,\n//       confirmButtonColor: '#3085d6',\n//       cancelButtonColor: '#d33',\n//       confirmButtonText: 'Yes'\n//     });\n//     if(!shouldDelete.isConfirmed) return;\n\n//     const campId = camp.id;\n//     const donorId = Number(this.route.snapshot.paramMap.get('id'));\n//     const item = {\n//       campId,\n//       donorId\n//     };\n\n//     this.bloodBankService.unregisterDonor(item).subscribe(\n//       (data: any) => {\n//         this.toast.success('Unregistered successfully');\n//         this.registeredCamps[camp.id] = false;\n//       },\n//       (error: any) => {\n//         this.toast.error(error.error.error.message);\n//       }\n//     );\n//   }\n// }\n\n\nimport { Component } from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { HotToastService } from '@ngneat/hot-toast';\nimport { BloodBankService } from '../blood-bank.service';\nimport { Observable, map } from 'rxjs';\nimport Swal from 'sweetalert2';\n\n@Component({\n  selector: 'app-donor-home',\n  templateUrl: './donor-home.component.html',\n  styleUrls: ['./donor-home.component.css']\n})\nexport class DonorHomeComponent {\n  registeredCamps: any = {};\n  camps: any;\n  donorId: any\n\n  constructor(\n    private toast: HotToastService,\n    private router: Router,\n    private route: ActivatedRoute,\n    private bloodBankService: BloodBankService\n  ) {}\n\n  ngOnInit(): void {\n    this.route.queryParams.subscribe(params => {\n      this.donorId = Number(params['id']);\n    });\n    window.history.pushState({}, document.title, \"/\" + \"donor-home\");\n    // window.history.pushState({}, document.title);\n    this.postCamps();\n  }\n\n  postCamps(): void {\n    this.bloodBankService.getCamps().subscribe(\n      (data: any) => {\n        this.camps = data;\n        // console.log(data);\n      }\n    );\n  }\n\n  convertTo12HourFormat(timeString: any): string {\n    const [hours, minutes] = timeString.split(\":\");\n    let formattedTime: number;\n    let period: string;\n\n    if (hours < 12) {\n      formattedTime = hours;\n      period = \"AM\";\n    } else {\n      formattedTime = hours % 12;\n      period = \"PM\";\n    }\n\n    return `${formattedTime}:${minutes} ${period}`;\n  }\n\n  isRegistered(camp: any, donorId: number): Observable<boolean> {\n    const campId = camp.id;\n    const item = {\n      campId,\n      donorId\n    };\n\n    return this.bloodBankService.isRegister(item).pipe(\n      map((data: any) => data.isRegistered)\n    );\n  }\n\n  getRegistrationStatus(donorId: number): void {\n    this.bloodBankService.campsRegistered(donorId).subscribe(\n      (data: any) => {\n        // console.log(data);\n        this.registeredCamps = data.reduce((result: any, camp: any) => {\n          result[camp.id] = true;\n          return result;\n        }, {});\n      }\n    );\n  }\n\n  onButtonClick(camp: any) {\n    // const donorId = Number(this.route.snapshot.queryParams['id']);\n    const isRegistered = this.registeredCamps[camp.id] || false;\n\n    if (isRegistered) {\n      this.unregisterCamp(camp, this.donorId);\n    } else {\n      this.registerCamp(camp, this.donorId);\n    }\n  }\n\n  registerCamp(camp: any, donorId: number) {\n    const campId = camp.id;\n    const item = {\n      campId,\n      donorId\n    };\n\n    this.bloodBankService.registerDonor(item).subscribe(\n      (data: any) => {\n        this.toast.success('Registered successfully');\n        this.registeredCamps[camp.id] = true;\n      },\n      (error: any) => {\n        this.toast.error(error.error.error.message);\n      }\n    );\n  }\n\n  async unregisterCamp(camp: any, donorId: number) {\n    const shouldDelete = await Swal.fire({\n      title: 'Are you sure?',\n      text: 'You want to unregister from camp',\n      icon: 'question',\n      showCancelButton: true,\n      confirmButtonColor: '#3085d6',\n      cancelButtonColor: '#d33',\n      confirmButtonText: 'Yes'\n    });\n    if(!shouldDelete.isConfirmed) return;\n\n    const campId = camp.id;\n    const item = {\n      campId,\n      donorId\n    };\n\n    this.bloodBankService.unregisterDonor(item).subscribe(\n      (data: any) => {\n        this.toast.success('Unregistered successfully');\n        this.registeredCamps[camp.id] = false;\n      },\n      (error: any) => {\n        this.toast.error(error.error.error.message);\n      }\n    );\n  }\n}\n\n","<div class=\"relative\">\n  <h1 class=\"absolute left-[30%] top-12 text-center text-5xl uppercase font-bold leading-9 tracking-wide text-rose-700\">Blood</h1>\n  <h1 class=\"absolute right-[32%] mr-2 top-12 text-center text-5xl uppercase font-bold leading-9 tracking-wide text-rose-700\">Bank\n    <span class=\"heart\"><span class=\"heartbeat\">ðŸ©¸</span></span>\n  </h1>\n  <div class=\"sm:mx-auto sm:w-full sm:max-w-sm\">\n    <img\n      class=\"mx-auto mt-2 w-32 h-28 shadow-danger shadow\"\n      src=\"https://png.pngtree.com/element_our/20200609/ourlarge/pngtree-donate-blood-image_2224076.jpg\"\n      alt=\"Your Company\"\n    />\n  </div>\n  <h1 class=\"uppercase underline text-3xl my-2 mt-4 text-center text-rose-800\">Camps List</h1>\n</div>\n\n\n\n\n<div class=\"flex flex-wrap justify-center overflow-hidden\">\n  <div class=\"m-4 shadow-lg\" *ngFor=\"let camp of camps\">\n    <div class=\"w-80 border border-gray-200 rounded-lg shadow\">\n      <img class=\"rounded-t-lg ml-2 h-36 border-b-2 border-b-rose-700\" src=\"https://gozo.news/wp-content/uploads/2019/02/Save_Life_Give_Blood_Malta.png\" alt=\"\" />\n      <div class=\"p-5 drop-shadow-sm\">\n        <h5 class=\"mb-4 text-xl uppercase underline text-center font-bold tracking-tight text-gray-900\">{{ camp.name }}</h5>\n        <div class=\"flex flex-col\">\n          <div class=\"flex items-start mb-4\">\n            <p class=\"mr-4 font-bold text-gray-600\">Organised By:</p>\n            <p class=\"font-normal text-gray-500\">{{ camp.createdBy }}</p>\n          </div>\n          <div class=\"flex items-start mb-4\">\n            <p class=\"mr-4 font-bold text-gray-600\">Location:</p>\n            <p class=\"font-normal text-gray-500\">{{ camp.location }}</p>\n          </div>\n          <div class=\"flex items-start mb-3\">\n            <p class=\"mr-4 font-bold text-gray-600\">Date:</p>\n            <p class=\"font-normal text-gray-500\">{{ camp.date }}</p>\n          </div>\n        </div>\n\n          <p class=\"mb-4 font-bold text-gray-600\">Timings:\n            <span class=\"bg-gray-100 text-gray-800 text-xs ml-2 font-medium inline-flex items-center px-2.5 py-0.5 rounded mr-2 border border-gray-500\">\n              <svg aria-hidden=\"true\" class=\"w-3 h-3 mr-1\" fill=\"currentColor\" viewBox=\"0 0 20 20\" xmlns=\"http://www.w3.org/2000/svg\"><path fill-rule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z\" clip-rule=\"evenodd\"></path></svg>\n              {{ convertTo12HourFormat(camp.startTime) }}\n            </span>-\n            <span class=\"bg-gray-100 text-gray-800 text-xs font-medium inline-flex items-center px-2.5 py-0.5 rounded border border-gray-500\">\n              <svg aria-hidden=\"true\" class=\"w-3 h-3 mr-1\" fill=\"currentColor\" viewBox=\"0 0 20 20\" xmlns=\"http://www.w3.org/2000/svg\"><path fill-rule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z\" clip-rule=\"evenodd\"></path></svg>\n              {{ convertTo12HourFormat(camp.endTime) }}\n            </span>\n          </p>\n          <!-- <button class=\"mt-2 w-full h-10 text-center font-bold cursor-pointer\"\n            (click)=\"onButtonClick(camp)\">\n          </button> -->\n          <button class=\"mt-2 w-full h-10 text-center font-bold cursor-pointer\"\n            (click)=\"onButtonClick(camp)\"\n            [ngClass]=\"{ button: !registeredCamps[camp.id], 'button-u': registeredCamps[camp.id] }\"\n          >\n            {{ registeredCamps[camp.id] ? 'Unregister' : 'Register' }}\n          </button>\n        </div>\n    </div>\n  </div>\n</div>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}